import std/json, std/base64, std/httpclient
proc getAccessToken*(refresh_token: string): string =
    var clientID = parseJson(readfile("clientID"))["web"]
    var key = encode( clientID["client_id"].getStr() & ":" & clientID["client_secret"].getStr())

    let authClient = newHttpClient()
    authClient.headers = newHttpHeaders({"Content-Type": "application/x-www-form-urlencoded",
            "Authorization": "Basic " & key})
    var ACCESS_TOKEN = ""
    try:
        var res = authClient.postContent("https://oauth2.googleapis.com/token?access_type=offline&prompt=consent",
                body = "grant_type=refresh_token&refresh_token=" & refresh_token)
        var resJson = parseJson(res)
        ACCESS_TOKEN = resJson["access_token"].getStr()
    finally:
        authClient.close()
    return ACCESS_TOKEN